<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>TirAssist ‚Äî –ü–∞—Ä–∫–æ–≤–∫–∏</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
  <link rel="stylesheet" href="style.css?v=14">
</head>
<body>

  <div id="map"></div>

  <!-- Top Bar -->
  <div id="top-bar">
    <div id="route-inline">
      <div class="route-inline-row">
        <span class="route-dot green"></span>
        <input type="text" id="route-from" placeholder="–û—Ç–∫—É–¥–∞" autocomplete="off">
      </div>
      <div class="route-inline-divider"></div>
      <div class="route-inline-row">
        <span class="route-dot red"></span>
        <input type="text" id="route-to" placeholder="–ö—É–¥–∞" autocomplete="off">
        <button id="route-go-btn" class="route-go-btn" title="–ù–∞–π—Ç–∏ –ø–∞—Ä–∫–æ–≤–∫–∏">‚Üí</button>
      </div>
      <button id="route-clear-btn" class="route-clear-btn hidden">‚úï –û—á–∏—Å—Ç–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
    </div>
    <div id="top-actions">
      <button id="layer-btn" class="action-btn" title="–°–ø—É—Ç–Ω–∏–∫">üõ∞Ô∏è</button>
      <button id="filter-btn" class="action-btn" title="–§–∏–ª—å—Ç—Ä—ã">‚öôÔ∏è</button>
      <button id="locate-btn" class="action-btn" title="–ú–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">üìç</button>
    </div>
  </div>

  <!-- Filter / Dims Panel -->
  <div id="filter-panel" class="floating-panel hidden">
    <div id="panel-tabs">
      <button class="panel-tab active" data-tab="filters">–§–∏–ª—å—Ç—Ä—ã</button>
      <button class="panel-tab" data-tab="dims">–ì–∞–±–∞—Ä–∏—Ç—ã</button>
    </div>

    <div id="pane-filters">

      <!-- –¢–∏–ø –ø–∞—Ä–∫–æ–≤–∫–∏ -->
      <div class="filter-section">
        <div class="filter-section-title">–¢–∏–ø –ø–∞—Ä–∫–æ–≤–∫–∏</div>
        <div class="filter-chips">
          <button class="chip type-chip" data-type="parking">
            <img src="parking_free.png" width="16" style="vertical-align:middle;margin-right:3px"> Parking
          </button>
          <button class="chip type-chip" data-type="spot">
            <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;margin-right:3px">
              <rect x="1" y="1" width="22" height="22" rx="4" fill="white" stroke="#aaa" stroke-width="1.5"/>
              <text x="12" y="13.5" font-family="Arial,sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">P</text>
              <text x="12" y="19.5" font-family="Arial,sans-serif" font-size="4.5" font-weight="bold" text-anchor="middle" fill="#333">SPOT</text>
            </svg>Spot
          </button>
          <button class="chip type-chip" data-type="prom">üè≠ Prom</button>
          <button class="chip type-chip" data-type="–º–∞–≥–∞–∑–∏–Ω">
            <img src="shop.png" width="16" style="vertical-align:middle;margin-right:3px"> –ú–∞–≥–∞–∑–∏–Ω
          </button>
        </div>
      </div>

      <!-- –£–¥–æ–±—Å—Ç–≤–∞ -->
      <div class="filter-section">
        <div class="filter-section-title">–£–¥–æ–±—Å—Ç–≤–∞</div>
        <div class="filter-chips">
          <button class="chip" data-filter="toilet">üöΩ –¢—É–∞–ª–µ—Ç</button>
          <button class="chip" data-filter="shower">üöø –î—É—à</button>
          <button class="chip" data-filter="restaurant">‚òï –ö–∞—Ñ–µ</button>
          <button class="chip" data-filter="laundry"><img src="laundry.png" width="16" style="vertical-align:middle;margin-right:3px"> –ü—Ä–∞—á–µ—á–Ω–∞—è</button>
        </div>
      </div>

      <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
      <div class="filter-section">
        <div class="filter-section-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</div>
        <div class="filter-chips">
          <button class="chip" data-filter="lighting">üí° –û—Å–≤–µ—â–µ–Ω–∏–µ</button>
          <button class="chip" data-filter="fencing">üöß –û–≥—Ä–∞–∂–¥–µ–Ω–∏–µ</button>
        </div>
      </div>

      <!-- –ö–∞—Ä—Ç—ã –æ–ø–ª–∞—Ç—ã -->
      <div class="filter-section">
        <div class="filter-section-title">–ö–∞—Ä—Ç—ã –æ–ø–ª–∞—Ç—ã</div>
        <div class="filter-chips">
          <button class="chip" data-filter="dkv">
            <img src="dkv.png" width="20" style="vertical-align:middle;margin-right:3px"> DKV
          </button>
          <button class="chip" data-filter="snap">
            <img src="snap.png" width="20" style="vertical-align:middle;margin-right:3px"> Snap
          </button>
        </div>
      </div>

      <!-- –û–ø–ª–∞—Ç–∞ -->
      <div class="filter-section">
        <div class="filter-section-title">–û–ø–ª–∞—Ç–∞</div>
        <div class="filter-chips">
          <button class="chip pay-btn" data-paid="false">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</button>
          <button class="chip pay-btn" data-paid="true">–ü–ª–∞—Ç–Ω–æ</button>
        </div>
      </div>

      <button id="filter-clear" class="secondary-btn">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</button>
    </div>

    <div id="pane-dims" class="hidden">
      <div class="dims-grid">
        <label class="dims-label">–í—ã—Å–æ—Ç–∞ (–º)<input id="dim-height" type="number" step="0.1" min="0" class="dims-input"></label>
        <label class="dims-label">–®–∏—Ä–∏–Ω–∞ (–º)<input id="dim-width" type="number" step="0.1" min="0" class="dims-input"></label>
        <label class="dims-label">–î–ª–∏–Ω–∞ (–º)<input id="dim-length" type="number" step="0.1" min="0" class="dims-input"></label>
        <label class="dims-label">–í–µ—Å (—Ç)<input id="dim-weight" type="number" step="1" min="0" class="dims-input"></label>
      </div>
      <button id="dims-save" class="primary-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>

  <!-- Add Parking FAB -->
  <button id="add-parking-btn" title="–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∫–æ–≤–∫—É">Ôºã</button>

  <!-- Add Parking Modal -->
  <div id="add-modal" class="hidden">
    <div id="add-modal-overlay" onclick="app.closeAddModal()"></div>
    <div id="add-modal-content">
      <div id="add-modal-header">
        <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∫–æ–≤–∫—É</h3>
        <button id="add-modal-close" onclick="app.closeAddModal()">‚úï</button>
      </div>
      <div id="add-modal-body">
        <div class="form-group">
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
          <input type="text" id="add-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Truck Stop A4">
        </div>
        <div class="form-group">
          <label>–¢–∏–ø –ø–∞—Ä–∫–æ–≤–∫–∏ *</label>
          <div class="filter-chips" style="margin-bottom:0">
            <button class="chip type-chip-add active" data-type="parking">
              <img src="parking_free.png" width="14" style="vertical-align:middle;margin-right:2px"> Parking
            </button>
            <button class="chip type-chip-add" data-type="spot">
              <svg width="14" height="14" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;margin-right:2px">
                <rect x="1" y="1" width="22" height="22" rx="4" fill="white" stroke="#aaa" stroke-width="1.5"/>
                <text x="12" y="13.5" font-family="Arial,sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">P</text>
                <text x="12" y="19.5" font-family="Arial,sans-serif" font-size="4.5" font-weight="bold" text-anchor="middle" fill="#333">SPOT</text>
              </svg>Spot
            </button>
            <button class="chip type-chip-add" data-type="prom">üè≠ Prom</button>
            <button class="chip type-chip-add" data-type="–º–∞–≥–∞–∑–∏–Ω">
              <img src="shop.png" width="14" style="vertical-align:middle;margin-right:2px"> –ú–∞–≥–∞–∑–∏–Ω
            </button>
          </div>
        </div>
        <div class="form-group">
          <label>–£–¥–æ–±—Å—Ç–≤–∞</label>
          <div class="services-grid">
            <label class="service-check"><input type="checkbox" value="toilet"> üöΩ –¢—É–∞–ª–µ—Ç</label>
            <label class="service-check"><input type="checkbox" value="shower"> üöø –î—É—à</label>
            <label class="service-check"><input type="checkbox" value="restaurant"> ‚òï –ö–∞—Ñ–µ</label>
            <label class="service-check"><input type="checkbox" value="laundry"> <img src="laundry.png" width="14" style="vertical-align:middle"> –ü—Ä–∞—á–µ—á–Ω–∞—è</label>
            <label class="service-check"><input type="checkbox" value="lighting"> üí° –û—Å–≤–µ—â–µ–Ω–∏–µ</label>
            <label class="service-check"><input type="checkbox" value="fencing"> üöß –û–≥—Ä–∞–∂–¥–µ–Ω–∏–µ</label>
          </div>
        </div>
        <div class="form-group">
          <label>–ö–∞—Ä—Ç—ã –æ–ø–ª–∞—Ç—ã</label>
          <div class="services-grid">
            <label class="service-check"><input type="checkbox" value="dkv"> <img src="dkv.png" width="20" style="vertical-align:middle"> DKV</label>
            <label class="service-check"><input type="checkbox" value="snap"> <img src="snap.png" width="20" style="vertical-align:middle"> Snap</label>
          </div>
        </div>
        <div class="form-group">
          <label>–°—Ç–æ–∏–º–æ—Å—Ç—å</label>
          <div class="filter-chips" style="margin-bottom:0">
            <button class="chip pay-btn-add active" data-paid="false">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</button>
            <button class="chip pay-btn-add" data-paid="true">–ü–ª–∞—Ç–Ω–æ</button>
          </div>
        </div>
        <div class="form-group">
          <label>üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</label>
          <input type="text" id="add-coords" placeholder="–ù–∞–ø—Ä: 52.2156, 20.7834" autocomplete="off">
          <button id="add-use-location-btn" class="secondary-btn" style="margin-top:8px">
            üìç –í—Å—Ç–∞–≤–∏—Ç—å –º–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
          </button>
        </div>
        <button id="add-submit-btn" class="primary-btn" style="margin-top:8px">
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Sheet -->
  <div id="bottom-sheet" class="hidden">
    <div id="sheet-drag-handle" onclick="app.hidePanel()">
      <div id="sheet-handle"></div>
    </div>
    <div id="sheet-content">
      <div id="sheet-header">
        <h2 id="parking-name"></h2>
        <span id="parking-distance" class="distance-badge hidden"></span>
      </div>
      <div id="parking-coords-row" class="hidden">
        <span id="parking-coords"></span>
        <button id="parking-coords-copy" class="copy-btn" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã">üìã</button>
      </div>
      <div id="parking-meta">
        <span id="parking-rating"></span>
      </div>
      <div id="services-row"></div>
      <button id="maps-btn" class="primary-btn maps-btn">
        üó∫Ô∏è –û—Ç–∫—Ä—ã—Ç—å –≤ Google Maps
      </button>
    </div>
  </div>

  <!-- Toast notification -->
  <div id="toast" class="toast hidden"></div>

  <!-- JS Libraries -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/@tmcw/togeojson@5.8.1/dist/togeojson.umd.js"></script>
  <script src="app.js?v=13"></script>
</body>
</html>
